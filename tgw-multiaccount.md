---
description: 'Update: 2021-09-09'
---

# TransitGateway ë©€í‹°ì–´ì¹´ìš´íŠ¸

## 1.Transit Gateway MultiAccount ì—°ê²°

### ê°œìš”

Transit GatewayëŠ” ë™ì¼ ë¦¬ì „ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ ê³„ì •ì—ì„œ Transit Gateway Peeringì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ ë¹Œë”ìŠ¤ ì»´í¼ë‹ˆì™€ í˜‘ë ¥ì‚¬ì¸ ì„œë°‹ ì»´í¼ë‹ˆëŠ” ìƒí˜¸ê°„ì— Transit Gateway Peeringì„ ë™ì¼ ë¦¬ì „ì—ì„œ ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê²½ìš° RAM\(Resource Access Manager\)ë¥¼ í†µí•´ì„œ ê°„ë‹¨í•˜ê²Œ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ë””ìì¸ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.

ì•„ë˜ì™€ ê°™ì´ ì„œìš¸ ë¦¬ì „ì•ˆì—ì„œ 2ê°œì˜ ê³„ì •ê°„ì— ê°œë°œ í˜‘ë ¥ì„ ìœ„í•´ ì—°ê²°í•˜ëŠ” ê³¼ì •ì„ ì†Œê°œí•©ë‹ˆë‹¤.

### RAM \(Resource Access Manager\) ì†Œê°œ

AWS Resource Access Manager \(RAM\)ëŠ” AWS ê³„ì • ë˜ëŠ” AWS ì¡°ì§ ë‚´ì—ì„œ AWS ë¦¬ì†ŒìŠ¤ë¥¼ ì‰½ê³  ì•ˆì „í•˜ê²Œ ê³µìœ  í•  ìˆ˜ìˆëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. AWS Transit Gateway, ì„œë¸Œë„·, AWS License Manager êµ¬ì„± ë° Amazon Route 53 Resolver ê·œì¹™ ë¦¬ì†ŒìŠ¤ë¥¼ RAMê³¼ ê³µìœ  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë§ì€ ì¡°ì§ì€ ê´€ë¦¬ ë˜ëŠ” ë¹„ìš©ì²˜ë¦¬ì— ëŒ€í•œ ë¶€ë¶„ì— ëŒ€í•´ ìƒí˜¸ê°„ì˜ ì˜í–¥ ì œí•œí•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ê³„ì •ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. RAMì„ ì‚¬ìš©í•˜ë©´ ì—¬ëŸ¬ ê³„ì •ì— ì¤‘ë³µ ë¦¬ì†ŒìŠ¤ë¥¼ ë§Œë“¤ í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ ì†Œìœ  í•œ ëª¨ë“  ë‹¨ì¼ ê³„ì •ì—ì„œ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ìš´ì˜ ì˜¤ë²„ í—¤ë“œê°€ ì¤„ì–´ ë“­ë‹ˆë‹¤. ì—¬ëŸ¬ê°œ ê³„ì • í™˜ê²½ì—ì„œ ì¤‘ì•™ ì§‘ì¤‘ì‹ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ê³  RAMì„ ì‚¬ìš©í•˜ì—¬ ë¦¬ì†ŒìŠ¤ ê³µìœ  ìƒì„±, ë¦¬ì†ŒìŠ¤ ì§€ì • ë° ê³„ì • ì„ ì´ë¼ëŠ” ì„¸ ê°€ì§€ ê°„ë‹¨í•œ ë‹¨ê³„ë¡œ ê³„ì •ê°„ì— í•´ë‹¹ ë¦¬ì†ŒìŠ¤ë¥¼ ê³µìœ  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. RAMì€ ì¶”ê°€ ë¹„ìš©ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**RAMì„ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.**

**ìš´ì˜ ì˜¤ë²„ í—¤ë“œ ê°ì†Œ**

ì¤‘ì•™ì—ì„œ AWS ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°ë‹¬í•˜ê³  RAMì„ ì‚¬ìš©í•˜ì—¬ ì„œë¸Œë„· ë˜ëŠ” ë¼ì´ì„ ìŠ¤ ê´€ë¦¬ì êµ¬ì„±ê³¼ ê°™ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ë‹¤ë¥¸ ê³„ì •ê³¼ ê³µìœ í•©ë‹ˆë‹¤. ì´ë ‡ê²Œí•˜ë©´ ë‹¤ì¤‘ ê³„ì • í™˜ê²½ì˜ ëª¨ë“  ê³„ì •ì— ì¤‘ë³µ ë¦¬ì†ŒìŠ¤ë¥¼ í”„ë¡œë¹„ì €ë‹ í•  í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ ëª¨ë“  ê³„ì •ì—ì„œ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ìš´ì˜ ì˜¤ë²„ í—¤ë“œê°€ ì¤„ì–´ ë“­ë‹ˆë‹¤.

**ë³´ì•ˆ ë° ê°€ì‹œì„± í–¥ìƒ**

RAMì€ AWS Identity and Access Management \(IAM\)ì— ì„¤ì •ëœ ê¸°ì¡´ ì •ì±…ê³¼ ê¶Œí•œì„ í™œìš©í•˜ì—¬ ê³µìœ  ë¦¬ì†ŒìŠ¤ì˜ ì‚¬ìš©ì„ ê´€ë¦¬í•©ë‹ˆë‹¤. RAMì€ ë˜í•œ Amazon CloudWatch ë° AWS CloudTrailê³¼ì˜ í†µí•©ì„ í†µí•´ ì•ŒëŒë¥¼ ì„¤ì •í•˜ê³ , ë¡œê·¸ë¥¼ ì‹œê°í™”í•˜ê¸° ìœ„í•´ ê³µìœ  ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ í¬ê´„ì  ì¸ ê°€ì‹œì„±ì„ ì œê³µí•©ë‹ˆë‹¤.

**ë¹„ìš© ìµœì í™”**

ê³„ì •ê°„ì— AWS License Manager êµ¬ì„±ê³¼ ê°™ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ê³µìœ í•˜ë©´ íšŒì‚¬ì˜ ì—¬ëŸ¬ ë¶€ë¶„ì—ì„œ ë¼ì´ì„ ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ í™œìš©ë„ë¥¼ ë†’ì´ê³  ë¹„ìš©ì„ ìµœì í™” í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### êµ¬ì„± ì•„í‚¤í…ì³ ì†Œê°œ

[TransitGateway êµ¬ì„±í•˜ê¸°](https://github.com/whchoi98/builders20210312/blob/master/transitgateway-basic.md)ì—ì„œ ìƒì„±í•œ ë¹Œë”ìŠ¤ ì»´í¼ë‹ˆì˜ Transit Gatewayë¥¼ ë™ì¼í•œ ì„œìš¸ ë¦¬ì „, ë‹¤ë¥¸ ì–´ì¹´ìš´íŠ¸\(ì„œë°‹ ì»´í¼ë‹ˆ\) Seoul-VPC-PART VPCì—ì„œ ì‚¬ìš©í•˜ë ¤ê³  í•˜ëŠ” ëª©í‘œ êµ¬ì„±ì…ë‹ˆë‹¤.

AWS RAM\(Resource Access Manager\)ë¥¼ ì´ìš©í•˜ì—¬ ë¹Œë”ìŠ¤ ì»´í¼ë‹ˆì˜ Transit Gatewayë¥¼ ì—°ê³„í•´ì„œ, í˜‘ë ¥ì‚¬ì¸ ì„œë°‹ ì»´í¼ë‹ˆ ìì›ì„ ì‚¬ìš©í•´ ë´…ë‹ˆë‹¤.

![](.gitbook/assets/image%20%2814%29.png)

## 2.ì„œë¡œ ë‹¤ë¥¸ ê³„ì •ì—ì„œ TGW ì—°ë™

### Task 1. VPC êµ¬ì„±í•˜ê¸°

**`ìƒˆë¡œìš´ ê³„ì •ì— ì ‘ì†`** í•˜ê³ , Cloudformationì„ í†µí•´ ê¸°ë³¸ì´ ë˜ëŠ” VPCêµ¬ì„±ì„ ë¨¼ì € êµ¬ì„±í•©ë‹ˆë‹¤.

**1.ì‚¬ì „ ì¤€ë¹„í•˜ê¸°**

ì„œìš¸ ë¦¬ì „ì— 4ê°œì˜ VPCë¥¼ êµ¬ì„±í•˜ê³ , ì‚¬ì „ì— êµ¬ì„±ëœ TGWë¥¼ ë°°í¬í•©ë‹ˆë‹¤.

ì•„ë˜ Githubì—ì„œ ì‹¤ìŠµì— ì‚¬ìš©í•  Cloudformation yaml íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤. **\(ì´ë¯¸ ë°›ì•˜ë‹¤ë©´ ìƒëµí•©ë‹ˆë‹¤.\)**

```text
git clone https://github.com/whchoi98/builders20210312
```

**2.Cloudformation ìƒì„±.**

{% hint style="warning" %}
**ì„œë°‹ ì»´í¼ë‹ˆëŠ” ì„œìš¸ë¦¬ì „ì—ì„œ ìƒˆë¡œìš´ ê³„ì •ìœ¼ Seoul-VPC-PARTë¼ëŠ” ì´ë¦„ìœ¼ë¡œ VPCë¥¼ ìƒì„±í•©ë‹ˆë‹¤.**
{% endhint %}

**`Seoul-VPC-PART`** ë¥¼ Cloudformation ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

![](.gitbook/assets/image%20%2831%29.png)

**AWS ì½˜ì†”ì—ì„œ ì„œìš¸ ë¦¬ì „ \(ap-northeast-2\)ë¥¼ ì„ íƒí•˜ê³ , Cloudformation ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.**

**Cloudformationì—ì„œ ë¨¼ì € ìƒˆë¡œìš´ ìŠ¤íƒì„ ìƒì„±í•©ë‹ˆë‹¤.**

**ì•ì„œ ë‹¤ìš´ë¡œë“œ ë°›ì€ yaml íŒŒì¼ë“¤ ì¤‘ì— `Seoul-VPC-PART.yml` íŒŒì¼ì„ ì—…ë¡œë“œ í•©ë‹ˆë‹¤.**

```text
Seoul-VPC-PART.yml
```

![](.gitbook/assets/image%20%2830%29.png)

ë‹¤ìŒì„ ì„ íƒí•˜ê³ , ì•„ë˜ì™€ ê°™ì•„ ìŠ¤íƒì´ë¦„ì€ íŒŒì¼ëª…ê³¼ ë™ì¼í•˜ê²Œ ì…ë ¥í•©ë‹ˆë‹¤.

![](.gitbook/assets/image%20%2846%29.png)

ë³„ë„ë¡œ ì„¤ì • ë³€ê²½ì—†ì´, ë‹¤ìŒ ë‹¨ê³„ë¥¼ ì§„í–‰í•˜ê³  , ìŠ¹ì¸ì„ ì„ íƒí•˜ê³  ìŠ¤íƒìƒì„±í•©ë‹ˆë‹¤.

![](.gitbook/assets/image%20%2851%29.png)

ì •ìƒì ìœ¼ë¡œ êµ¬ì„±ë˜ë©´ ì•„ë˜ì™€ ê°™ì´ Cloudformationì—ì„œ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. VPCëŠ” ê° 3ë¶„ ë‚´ì™¸ì— ìƒì„±ë©ë‹ˆë‹¤.

![](.gitbook/assets/image%20%289%29.png)

ì„œë°‹ ì»´í¼ë‹ˆ ê³„ì˜ ë²ˆí˜¸ë¥¼ ë³µì‚¬í•´ ë‘¡ë‹ˆë‹¤. RAM êµ¬ì„±ì‹œ ê³„ì • ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤.

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%2852%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%2852%29.png)

### Task 2. RAM êµ¬ì„±í•˜ê¸°

**ì´ì œ ë‹¤ì‹œ ë¹Œë”ìŠ¤ ì»´í¼ë‹ˆ ê³„ì •ì—ì„œ ìˆ˜í–‰í•©ë‹ˆë‹¤.**

{% hint style="info" %}
ë¹Œë”ìŠ¤ ì»´í¼ë‹ˆì—ì„œ ìƒì„±ëœ TGWë¥¼ ì„œë°‹ ì»´í¼ë‹ˆì—ê²Œ ì œê³µí•  ê²ƒì…ë‹ˆë‹¤. ë°˜ë“œì‹œ RAM êµ¬ì„±ì€ ë¦¬ì†ŒìŠ¤ ì œê³µí•˜ëŠ” ê³„ì •ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤.
{% endhint %}

**AWS ê´€ë¦¬ì½˜ì†”ì—ì„œ RAM ì„ ì„ íƒí•˜ê³ , ìƒˆë¡œìš´ ìœˆë„ìš° ì°½ì„ ì˜¤í”ˆí•©ë‹ˆë‹¤.**

**`ë¹Œë”ìŠ¤ ê³„ì • - AWS ì½˜ì†” - RAM`**

![](.gitbook/assets/image%20%2817%29.png)

**`Resource Access Manager - ë‚´ê°€ ê³µìœ : ë¦¬ì†ŒìŠ¤ ê³µìœ `** ì—ì„œ **`"ë¦¬ì†ŒìŠ¤ ê³µìœ  ìƒì„±"`** ì„ ì„ íƒí•©ë‹ˆë‹¤.

![](.gitbook/assets/image%20%2842%29.png)

ì•„ë˜ì™€ ê°’ì„ ì…ë ¥í•©ë‹ˆë‹¤.

* **ì´ë¦„** - "ë¦¬ì†ŒìŠ¤ ê³µìœ  ì´ë¦„" ì„ ì…ë ¥í•©ë‹ˆë‹¤.

```text
Seoul-TGW
```

* `ë¦¬ì†ŒìŠ¤ ìœ í˜• ì„ íƒ - ì „ì†¡ ê²Œì´íŠ¸ì›¨ì´ (Transit Gateway)`ë¥¼ ì„ íƒí•˜ê³ , ìƒì„±í•´ ë†“ì€ TGWë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
* **`Principal - ì™¸ë¶€ ê³„ì •`** í—ˆìš© ì„ ì„ íƒí•©ë‹ˆë‹¤. ì•ì„œ ìƒˆë¡­ê²Œ Seoul-VPC-PART VPC ìì›ì´ ìƒì„±ëœ ê³„ì •ì˜ ë²ˆí˜¸ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤. \(ì•ì„œ ë³µì‚¬í•´ ë‘” ì„œë°‹ ì»´í¼ë‹ˆì˜ ê³„ì •ì…ë‹ˆë‹¤.\)

![](.gitbook/assets/image%20%2834%29.png)

ë¦¬ì†ŒìŠ¤ ê³µìœ ë¥¼ í™•ì¸í•˜ê³ , ìƒì„±í•œ ë¦¬ì†ŒìŠ¤ ê³µìœ ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

![](.gitbook/assets/image%20%2832%29.png)

Associating ë‹¨ê³„ë¡œ ì§„í–‰ ì¤‘ì¸ ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![](.gitbook/assets/image%20%2823%29.png)

ì´ì œ ê³µìœ ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´, í˜‘ë ¥ì‚¬ì¸ ì„œë°‹ ì»´í¼ë‹ˆ ê³„ì • ì½˜ì†”ë¡œ ì´ë™í•´ì„œ RAMìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.

**`ì„œë°‹ ì»´í¼ë‹ˆ - AWS ê³„ì • - RAM`** ì„ ì„ íƒí•©ë‹ˆë‹¤.

`ë¦¬ì†ŒìŠ¤ ê³µìœ `ì— `ì´ˆëŒ€ ì•ŒëŒ`ì´ ìƒì„±ëœ ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¦¬ì†ŒìŠ¤ ê³µìœ ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

![](.gitbook/assets/image%20%284%29.png)

í•´ë‹¹ ë¦¬ì†ŒìŠ¤ ê³µìœ ë¥¼ ì„ íƒí•˜ë©´, ë¦¬ì†ŒìŠ¤ ê³µìœ  ìˆ˜ë½ì„ ëŒ€ê¸°í•˜ê³  ìˆëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³µìœ ëœ ë¦¬ì†ŒìŠ¤ Seoul-TGW ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.



ë¦¬ì†ŒìŠ¤ ê³µìœ  ìˆ˜ë½ì„ ì„ íƒí•©ë‹ˆë‹¤.

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%2813%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%2813%29.png)

AWS ê³„ì • - VPC - TransitGatewayì— ë¹Œë”ìŠ¤ ì»´í¼ë‹ˆ ê³„ì •ì˜ Seoul-TGWê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%2835%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%2835%29.png)

#### 

#### 

#### Task 3. TGW ì—°ë™í•˜ê¸°

ì„œë°‹ ì»´í¼ë”” ê³„ì •ì—ì„œ Transit Gateway Attachmentë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´, \*\*`VPC - Transit Gateway - Transit Gateway ì—°ê²°`\*\*ì„ ì„ íƒí•´ì„œ ìƒˆë¡œìš´ Attachmentë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

* Transit Gateway ID : ê³µìœ ëœ TGW
* Attachment name tag : Attachment ì´ë¦„ \(Seoul-TGW-Attach-Seoul-VPC-PART\)
* VPC ID : ì„œë°‹ ì»´í¼ë‹ˆì˜ VPC ì„ íƒ \(Seoul-VPC-PART\)
* Subnet : TGW ENIê°€ ì—°ê²°ëœ ì„œë¸Œë„· ì„ íƒ \(Seoul-VPC-TGWSubnetA, Seoul-VPC-TGWSubnetB\)

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%2830%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%2830%29.png)

**`VPC - Transit Gateway - Transit Gateway`** ì—°ê²° ì—ì„œ ì •ìƒì ìœ¼ë¡œ êµ¬ì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%2877%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%2877%29.png)

ë¼ìš°íŒ… í…Œì´ë¸”ì—ì„œ Assocationì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

{% hint style="info" %} TGWì™€ Routing Table ìì›ì€ ëª¨ë‘ ë¹Œë”ìŠ¤ ì»´í¼ë‹ˆ ê³„ì • ì†Œìœ  ì…ë‹ˆë‹¤. ë”°ë¼ì„œ Assocation, Routing Table êµ¬ì„±ì€ ë¹Œë”ìŠ¤ ê³„ì •ì—ì„œ ìˆ˜í–‰í•©ë‹ˆë‹¤. {% endhint %}

**ì´ì œ ë‹¤ì‹œ ë¹Œë”ìŠ¤ ê³„ì •ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.**

\*\*`ë¹Œë”ìŠ¤ ê³„ì • - AWS ì½˜ì†” - VPC- Transit Gateway - Transit Gateway ë¼ìš°íŒ… í…Œì´ë¸”`\*\*ì—ì„œ **`"Seoul-TGW-RT-East-To-West"`** í…Œì´ë¸”ì„ ì„ íƒí•©ë‹ˆë‹¤. ìƒˆë¡­ê²Œ ì¶”ê°€ëœ ì„œë°‹ ì»´í¼ë‹ˆ ê³„ì •ì˜ **Transit Gateway Attachmentë¥¼ ì„ íƒí•˜ê³  ì¶”ê°€**í•©ë‹ˆë‹¤.

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%2868%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%2868%29.png)

**`AWS ì½˜ì†” - VPC- Transit Gateway - Transit Gateway ë¼ìš°íŒ… í…Œì´ë¸” - "Seoul-TGW-RT-East-To-West" - Assosications Tab`** ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. ì •ìƒì ìœ¼ë¡œ Association ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%2846%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%2846%29.png)

**`AWS ì½˜ì†” - VPC- Transit Gateway - Transit Gateway ë¼ìš°íŒ… í…Œì´ë¸” - Propagations Tab`** ì„ ì„ íƒí•˜ê³ , ì„œë°‹ ì»´í¼ë‹ˆì˜ Seoul-VPC-PART ë¥¼ propagation í•©ë‹ˆë‹¤.

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%2860%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%2860%29.png)

**`AWS ì½˜ì†” - VPC- Transit Gateway - Transit Gateway ë¼ìš°íŒ… í…Œì´ë¸” - Propagations Tab`** ì„ ì„ íƒí•˜ã…ê³ , ì •ìƒì ìœ¼ë¡œ Propagation ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%2856%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%2856%29.png)

**`AWS ì½˜ì†” - VPC- Transit Gateway - Transit Gateway ë¼ìš°íŒ… í…Œì´ë¸” - Route Tab`** ì„ ì„ íƒê³ , ì •ìƒì ìœ¼ë¡œ Routeê°€ ì¶”ê°€ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%289%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%289%29.png)

ì„œë°‹ ì»´í¼ë‹ˆ ê³„ì •ì—ì„œ SEOUL-VPC-PRT-Private-10.4.21.101 ì„ ì ‘ì†í•©ë‹ˆë‹¤.

SEOUL-VPC-PRT-Private-10.4.21.101 id í™•ì¸.

ê³„ì •ì´ 2ê°œ êµ¬ì„±ë˜ì–´ aws cliëŠ” default profileë¡œ ì ‘ê·¼ì´ ë©ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì´ 2ê°œì˜ êµ¬ì„±ì„ ê´€ë¦¬ì PC ë˜ëŠ” ë¦¬ëˆ…ìŠ¤ì—ì„œ ì„¤ì •í•©ë‹ˆë‹¤.

```text
~/.aws/config
[profile builders]
region = ap-northeast-2
output = json
[profile summit]
region = ap-northeast-2
output = json

~/.aws/credentials
[builders]
aws_access_key_id = xxxxxx
aws_secret_access_key = xxxxx
[summit]
aws_access_key_id = xxxxxx
aws_secret_access_key = xxxxx
```

í™˜ê²½ì„¤ì •ì„ ì•„ë˜ì™€ ê°™ì´ ìŠ¤ìœ„ì¹­í•˜ë©´ì„œ ì—°ê²°í•©ë‹ˆë‹¤.

```text
###builders ê³„ì •
export AWS_DEFAULT_PROFILE=builders

##summit ê³„ì •
export AWS_DEFAULT_PROFILE=builders
```

ì•„ë˜ì™€ ê°™ì´ Seoul-VPC-PART-Private-10.4.21.101 ì¸ìŠ¤í„´ìŠ¤ idë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

```text
~/environment/buildernet/aws_ec2_ext.sh  | grep "Seoul-VPC-PART-Private-10.4.21.101"
```

Seoul-VPC-PART-Private-10.4.21.101 ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•©ë‹ˆë‹¤.

```text
aws ssm start-session --target "Seoul-VPC-PART-Private-10.4.21.101 id"
```

ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ Seoul-VPC-DEV,STG ì˜ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì—°ê²°ì´ ê°€ëŠ¥í•œì§€ í™•ì¸í•©ë‹ˆë‹¤.

```text
sudo -s
echo 10.0.21.101 SEOUL-VPC-HQ-Private >> /etc/hosts 
echo 10.1.21.101 SEOUL-VPC-PRD-Private >> /etc/hosts
echo 10.2.21.101 SEOUL-VPC-STG-Private >> /etc/hosts
echo 10.3.21.101 SEOUL-VPC-DEV-Private >> /etc/hosts
echo 10.4.21.101 SEOUL-VPC-PRT-Private >> /etc/hosts
echo 10.5.21.101 IAD-VPC-Private >> /etc/hosts
ping SEOUL-VPC-DEV-Private

```

ì´ì œ Seoul-VPC-PARTì—ì„œ Seoul-VPC-DEV, Seoul-VPC-STGë¡œ í†µì‹ ì„ í•˜ê¸° ìœ„í•´, 10.0.0.0/8ì˜ ëª©ì ì§€ë¥¼ Transit Gatewayë¡œ ì¶”ê°€í•©ë‹ˆë‹¤.

[![](https://github.com/whchoi98/builders20210312/raw/master/.gitbook/assets/image%20%2848%29.png)](https://github.com/whchoi98/builders20210312/blob/master/.gitbook/assets/image%20%2848%29.png)

{% hint style="info" %} Seoul-VPC-PARTì—ì„œ Seoul-VPC-PRD ë¡œë„ ì ‘ê·¼ì´ ê°€ëŠ¥í•  ê²ƒì…ë‹ˆë‹¤. ëª¨ë“  VPCì—ì„œ 10.0.0.0/8ì˜ ëª©ì ì§€ë¥¼ TGWë¡œ êµ¬ì„±í–ˆê¸´ ë•Œë¬¸ì…ë‹ˆë‹¤. ë³´ì•ˆ ê°•í™”ë¥¼ ì´ëŸ¬í•œ ê²½ìš°ì—ëŠ” VPCë“¤ì˜ CIDRì„ Propagation í•˜ì§€ ì•Šê³ , Staticìœ¼ë¡œ ì²˜ë¦¬í•˜ë©´ ì ‘ê·¼ ì œì–´ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. {% endhint %}

ì´ì œ Seoul-VPC-PART-Private-10.4.21.101 ì—ì„œ DEV, STGë¡œ íŠ¸ë˜í”½ì„ ì²´í¬ë¥¼ í•´ë³´ì„¸ìš”. PRDë„ í™•ì¸ í•´ ë³´ì„¸ìš”.

```text
ping SEOUL-VPC-DEV-Private
ping SEOUL-VPC-STG-Private
ping SEOUL-VPC-PRD-Private
```

{% hint style="success" %} MultiAccountì˜ ê°™ì€ ë¦¬ì „ì—ì„œ TGW ì—°ë™ì„ í™•ì¸í•´ ë³´ì•˜ìŠµë‹ˆë‹¤. Propagationê³¼ Static ì¡°í•©ì„ í†µí•´ì„œ VPC ê²©ë¦¬ì™€ ë³´ì•ˆì„ ê°•í™”í•˜ëŠ” ì—¬ëŸ¬ê°€ì§€ ë””ìì¸ì„ êµ¬ì„±í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. {% endhint %}

**í•´ë‹¹ LABì˜ ì§ˆë¬¸ ì‚¬í•­ì€ whchoi98@gmail.com/ whchoi@amazon.com ë˜ëŠ”ğŸ™‹â™‚ ìŠ¬ë™ì±„ë„\(https://whchoi-hol.slack.com/ , https://join.slack.com/t/whchoi-hol/shared\_invite/zt-necc66t1-n6pSgrVfGW1w6SLAQUTP8A\) \#aws-builders-adv-networking-hol ì—ì„œ ë¬¸ì˜ ê°€ëŠ¥í•©ë‹ˆë‹¤.**

